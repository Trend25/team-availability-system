<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setup Wizard - Team Availability System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .wizard-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            max-width: 800px;
            width: 100%;
            overflow: hidden;
        }

        .wizard-header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .wizard-content {
            padding: 40px;
        }

        .step {
            display: none;
        }

        .step.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }

        .step-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #dee2e6;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .step-dot.active {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            transform: scale(1.2);
        }

        .step-dot.completed {
            background: #28a745;
            color: white;
        }

        h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin: 15px 0;
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn:disabled {
            background: #dee2e6;
            cursor: not-allowed;
            transform: none;
        }

        .checklist {
            list-style: none;
            padding: 0;
        }

        .checklist li {
            padding: 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checklist li:before {
            content: "☐";
            font-size: 1.5rem;
            color: #6c757d;
        }

        .checklist li.checked:before {
            content: "☑";
            color: #28a745;
        }

        a {
            color: #4facfe;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .result-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .copy-button {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .copy-button:hover {
            background: #218838;
        }
    </style>
</head>
<body>
    <div class="wizard-container">
        <div class="wizard-header">
            <h1>Team Availability System</h1>
            <p>Setup Wizard / Kurulum Sihirbazı</p>
        </div>

        <div class="wizard-content">
            <div class="step-indicator">
                <div class="step-dot active" id="dot-1">1</div>
                <div class="step-dot" id="dot-2">2</div>
                <div class="step-dot" id="dot-3">3</div>
                <div class="step-dot" id="dot-4">4</div>
            </div>

            <!-- STEP 1: Welcome -->
            <div class="step active" id="step-1">
                <h2>Hoş Geldiniz! / Welcome!</h2>
                
                <div class="info-box">
                    <strong>Bu sihirbaz size yardımcı olacak:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>GitHub repository oluşturma</li>
                        <li>Personal Access Token alma</li>
                        <li>İlk admin hesabını kurma</li>
                        <li>Sistemi test etme</li>
                    </ul>
                </div>

                <div class="warning-box">
                    <strong>Gereksinimler:</strong><br>
                    Bir GitHub hesabınız olmalı. Yoksa <a href="https://github.com/signup" target="_blank">buradan</a> ücretsiz oluşturabilirsiniz.
                </div>

                <p><strong>Tahmini süre:</strong> 15-20 dakika</p>

                <div class="button-group">
                    <div></div>
                    <button class="btn btn-primary" onclick="nextStep()">Başla / Start →</button>
                </div>
            </div>

            <!-- STEP 2: GitHub Setup -->
            <div class="step" id="step-2">
                <h2>GitHub Repository Kurulumu</h2>
                
                <div class="info-box">
                    <strong>Yapmanız gerekenler:</strong>
                </div>

                <ol style="margin-left: 20px; line-height: 2;">
                    <li>GitHub'a gidin: <a href="https://github.com/new" target="_blank">github.com/new</a></li>
                    <li><strong>Repository name:</strong> <code>team-availability-data</code></li>
                    <li><strong>Visibility:</strong> Public (veya Private)</li>
                    <li>"Add a README file" kutusunu işaretleyin</li>
                    <li>"Create repository" butonuna tıklayın</li>
                </ol>

                <div class="warning-box">
                    <strong>Not:</strong> Repository adını tam olarak <code>team-availability-data</code> yapın veya farklı bir ad kullanırsanız not edin.
                </div>

                <div class="form-group">
                    <label for="repoName">Repository adını doğrulayın:</label>
                    <input type="text" id="repoName" value="team-availability-data" placeholder="repository-name">
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">← Geri</button>
                    <button class="btn btn-primary" onclick="nextStep()">Devam →</button>
                </div>
            </div>

            <!-- STEP 3: GitHub Token -->
            <div class="step" id="step-3">
                <h2>GitHub Personal Access Token</h2>
                
                <div class="info-box">
                    Token, uygulamanın GitHub repository'nize erişmesini sağlar.
                </div>

                <ol style="margin-left: 20px; line-height: 2;">
                    <li>GitHub Settings → Developer settings → <a href="https://github.com/settings/tokens" target="_blank">Personal access tokens</a></li>
                    <li>"Tokens (classic)" seçin</li>
                    <li>"Generate new token" → "Generate new token (classic)"</li>
                    <li><strong>Note:</strong> "Team Availability System"</li>
                    <li><strong>Expiration:</strong> "No expiration" veya "1 year"</li>
                    <li><strong>Select scopes:</strong> Sadece <code>repo</code> kutusunu işaretleyin</li>
                    <li>"Generate token" butonuna tıklayın</li>
                    <li><strong>Token'ı KOPYALAYIN</strong> (bir daha gösterilmeyecek!)</li>
                </ol>

                <div class="warning-box">
                    <strong>Kritik:</strong> Token'ı güvenli bir yerde saklayın. Bu token repository'nize tam erişim sağlar.
                </div>

                <div class="form-group">
                    <label for="githubUsername">GitHub Kullanıcı Adınız:</label>
                    <input type="text" id="githubUsername" placeholder="your-github-username">
                </div>

                <div class="form-group">
                    <label for="githubToken">Personal Access Token:</label>
                    <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx">
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">← Geri</button>
                    <button class="btn btn-primary" onclick="testConnection()">Bağlantıyı Test Et</button>
                </div>

                <div id="connectionResult"></div>
            </div>

            <!-- STEP 4: Config File -->
            <div class="step" id="step-4">
                <h2>Kurulum Tamamlandı!</h2>
                
                <div class="success-box">
                    <strong>Tebrikler!</strong> GitHub bağlantısı başarılı.
                </div>

                <div class="info-box">
                    <strong>Şimdi yapmanız gerekenler:</strong>
                    <ol style="margin-left: 20px; margin-top: 10px;">
                        <li>Ana uygulamayı açın (index.html)</li>
                        <li>"Kurulum" sekmesine gidin</li>
                        <li>Aşağıdaki bilgileri girin</li>
                        <li>İlk admin hesabını oluşturun</li>
                    </ol>
                </div>

                <div class="result-panel">
                    <h3>Kurulum Bilgileriniz:</h3>
                    <div class="code-block" id="configSummary">
                        GitHub Username: -
                        Repository: -
                        Token: -
                    </div>
                    <button class="copy-button" onclick="copyConfig()">Bilgileri Kopyala</button>
                </div>

                <div class="warning-box" style="margin-top: 20px;">
                    <strong>Güvenlik Notu:</strong><br>
                    Token'ınızı kimseyle paylaşmayın. index.html dosyasını açtıktan sonra bu bilgileri oraya girin.
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">← Geri</button>
                    <button class="btn btn-primary" onclick="openMainApp()">Ana Uygulamayı Aç →</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let setupData = {
            username: '',
            repo: 'team-availability-data',
            token: '',
            verified: false
        };

        function nextStep() {
            if (currentStep === 2) {
                const repoName = document.getElementById('repoName').value.trim();
                if (!repoName) {
                    alert('Repository adını girin!');
                    return;
                }
                setupData.repo = repoName;
            }

            if (currentStep < 4) {
                document.getElementById('step-' + currentStep).classList.remove('active');
                document.getElementById('dot-' + currentStep).classList.remove('active');
                document.getElementById('dot-' + currentStep).classList.add('completed');
                
                currentStep++;
                
                document.getElementById('step-' + currentStep).classList.add('active');
                document.getElementById('dot-' + currentStep).classList.add('active');
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                document.getElementById('step-' + currentStep).classList.remove('active');
                document.getElementById('dot-' + currentStep).classList.remove('active');
                
                currentStep--;
                
                document.getElementById('step-' + currentStep).classList.add('active');
                document.getElementById('dot-' + currentStep).classList.add('active');
                document.getElementById('dot-' + currentStep).classList.remove('completed');
            }
        }

        async function testConnection() {
            const username = document.getElementById('githubUsername').value.trim();
            const token = document.getElementById('githubToken').value.trim();
            const repo = setupData.repo;

            if (!username || !token) {
                showResult('Kullanıcı adı ve token gerekli!', 'error');
                return;
            }

            showResult('Bağlantı test ediliyor...', 'info');

            try {
                const response = await fetch(`https://api.github.com/repos/${username}/${repo}`, {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (response.ok) {
                    setupData.username = username;
                    setupData.token = token;
                    setupData.verified = true;
                    
                    showResult('Bağlantı başarılı! Repository bulundu.', 'success');
                    
                    setTimeout(() => {
                        updateConfigSummary();
                        nextStep();
                    }, 1500);
                } else if (response.status === 404) {
                    showResult('Repository bulunamadı. Adını kontrol edin veya önce repository oluşturun.', 'error');
                } else if (response.status === 401) {
                    showResult('Token geçersiz. Yeni bir token oluşturun ve "repo" yetkisini seçtiğinizden emin olun.', 'error');
                } else {
                    showResult(`Bağlantı hatası: ${response.status}`, 'error');
                }
            } catch (error) {
                showResult('Bağlantı hatası: ' + error.message, 'error');
            }
        }

        function showResult(message, type) {
            const resultDiv = document.getElementById('connectionResult');
            const className = type === 'success' ? 'success-box' : 
                            type === 'error' ? 'warning-box' : 'info-box';
            resultDiv.innerHTML = `<div class="${className}" style="margin-top: 20px;">${message}</div>`;
        }

        function updateConfigSummary() {
            const summary = `GitHub Username: ${setupData.username}
Repository: ${setupData.repo}
Token: ${setupData.token.substring(0, 10)}...`;
            
            document.getElementById('configSummary').textContent = summary;
        }

        function copyConfig() {
            const text = `GitHub Username: ${setupData.username}
Repository: ${setupData.repo}
Token: ${setupData.token}`;
            
            navigator.clipboard.writeText(text).then(() => {
                alert('Bilgiler kopyalandı! index.html\'i açıp kurulum sekmesine yapıştırın.');
            });
        }

        function openMainApp() {
            // Try to open index.html in the same directory
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
